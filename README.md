# Распределенное Key-Value хранилище на базе B+Tree

conda env create -f environment-py312.yml

- Ключи (значения!) храниятся в простом питоновском списке
- данные (строки) также хранятсяв простом питоновском скиске списке либо на другом сервере
  - в случае, если в списке, то вариант:
    - данные - это объект некоторого класса, у которого имеется метод get_pkey()
      который возвращает структуру вида: 
      ````python
        class <ИмяКлассаКлюча>(msgpack.Struct, freeze=True, order=True):
            """ это первичный ключ 
                freeze=True - неизменяемое
                order=True содержит методы сравнения >, <, ==, >=, <=
            """
            <список полей>
      ````
- Само B+Tree дерево содержит только ссылки на ключи в виде numpy.int32

- Существует два вида узлов - `листовые` и `внутренние`
  - они отличаются друг от друга наличием поля `descendants` во внутренних узлах
- В качестве ключей используется msgspec.Struct
- Реализация уникальных/неуникальных индексов:
  - на самом деле, все индексы - уникальны, т.к. уникальным образом
    идентифицируют запись
  - поэтому для неуникальных индексов нужно лишь включить в значение ключа указатель на конкретную запись
    и индекс сразу станет уникальным

- при вставке в заполненный узел сначала выполняется операция расщепления (рекурсивно)
  - после процедуры расщепления определяется в какую из двух незаполненных таблиц нужно вставить запись
  - поэтому процедуре расщепления необходимо знать лишь ключ по которому расщепление было выполнено + код узла, на которорый переходить

DONE:
- insert: key
- validate BPTree
- min

TODO:
- find: == key
- UPSERT: key
- UPDATE: key
- UPSERT: key

- find: >, >= key + cursor
- find: <, <= key + cursor

- max
- DELETE: key
